
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Services Catalogue - Solarium Customer App</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: #f8f9fa;
        }
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: #ffffff;
            padding: 0;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            border-right: 1px solid #e9ecef;
        }
        .sidebar h3 {
            background: #007bff;
            color: white;
            margin: 0;
            padding: 20px;
            font-size: 18px;
            font-weight: 600;
        }
        .nav-section {
            padding: 20px 0;
        }
        .nav-section h4 {
            color: #6c757d;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0 20px 10px 20px;
            padding: 0;
        }
        .nav-link {
            display: block;
            color: #495057;
            text-decoration: none;
            padding: 12px 20px;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        .nav-link:hover {
            background: #f8f9fa;
            color: #007bff;
            border-left-color: #007bff;
        }
        .nav-link.active {
            background: #e3f2fd;
            color: #007bff;
            border-left-color: #007bff;
        }
        .main-content {
            margin-left: 280px;
            padding: 40px;
            background: white;
            min-height: 100vh;
        }
        .content {
            max-width: 800px;
            line-height: 1.6;
        }
        pre {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #e9ecef;
        }
        code {
            background: #f8f9fa;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            color: #e83e8c;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2, h3 {
            color: #2c3e50;
            margin-top: 30px;
        }
        .breadcrumb {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #6c757d;
        }
        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h3>Solarium Customer App</h3>
        <nav>
            <div class="nav-section"><a href="index.html" class="nav-link">üè† Home</a></div><div class="nav-section"><h4>Core Features</h4><a href="CartCheckout.html" class="nav-link">Cart Checkout</a><a href="CartFunctionality.html" class="nav-link">Cart Functionality</a><a href="KycUploadLibrary.html" class="nav-link">KYC Upload Library</a><a href="ServicesCatalogue.html" class="nav-link">Services Catalogue</a><a href="profile-feature.html" class="nav-link">Profile Management</a></div><div class="nav-section"><h4>Support System</h4><a href="TicketManagement.html" class="nav-link">Ticket Management System</a></div><div class="nav-section"><h4>Testing & QA</h4><a href="TESTING.html" class="nav-link">Testing Guide</a><a href="Testing_services_cart.html" class="nav-link">Testing Services & Cart</a></div><div class="nav-section"><h4>DevOps</h4><a href="CI_CD.html" class="nav-link">CI/CD Pipeline</a></div><div class="nav-section"><h4>Other</h4><a href="LeadDetail.html" class="nav-link">Lead Detail</a></div>
        </nav>
    </div>
    <div class="main-content">
        <div class="breadcrumb">Documentation ‚Üí Services Catalogue</div>
        <div class="content">
            <h1>Services Catalogue Feature</h1>
<h2>Overview</h2>
<p>The Services Catalogue provides customers with a browsable list of solar services they can add to their cart. This feature is designed for online-only operation with real-time cart management and accessibility support.</p>
<h2>Architecture</h2>
<h3>Key Components</h3>
<ul>
<li><strong>Services API</strong> (<code>src/api/endpoints/services.ts</code>) - RTK Query endpoints for fetching services</li>
<li><strong>Cart Management</strong> (<code>src/store/servicesCartSlice.ts</code>) - Redux slice for cart state</li>
<li><strong>Services Screen</strong> (<code>src/screens/main/ServicesScreen.tsx</code>) - Main UI with cart integration</li>
<li><strong>Cart Badge</strong> (<code>src/components/common/CartBadge/</code>) - Real-time cart count display</li>
</ul>
<h3>Data Flow</h3>
<pre><code>API (5-8 services) ‚Üí RTK Query ‚Üí Services Screen ‚Üí Cart Actions ‚Üí Redux Store ‚Üí Persistence
</code></pre>
<h2>Services API</h2>
<h3>Endpoints</h3>
<h4>Get Services List</h4>
<pre><code class="language-typescript">const {data: services, isLoading, error} = useGetServicesQuery({active: true});
</code></pre>
<p><strong>Response Format:</strong></p>
<pre><code class="language-json">{
  &quot;success&quot;: true,
  &quot;data&quot;: {
    &quot;items&quot;: [
      {
        &quot;serviceId&quot;: &quot;solar-panel-install&quot;,
        &quot;name&quot;: &quot;Solar Panel Installation&quot;,
        &quot;description&quot;: &quot;Complete solar panel installation service&quot;,
        &quot;type&quot;: &quot;installation&quot;,
        &quot;active&quot;: true,
        &quot;priceRange&quot;: {
          &quot;min&quot;: 50000,
          &quot;max&quot;: 150000,
          &quot;currency&quot;: &quot;INR&quot;
        },
        &quot;category&quot;: &quot;installation&quot;,
        &quot;features&quot;: [&quot;Premium panels&quot;, &quot;Professional installation&quot;],
        &quot;estimatedDuration&quot;: &quot;3-5 days&quot;
      }
    ],
    &quot;total&quot;: 5
  }
}
</code></pre>
<h4>Get Service by ID</h4>
<pre><code class="language-typescript">const {data: service} = useGetServiceByIdQuery(serviceId);
</code></pre>
<h3>Error Handling</h3>
<p>Services API uses <code>ServiceFetchError</code> for typed error handling:</p>
<pre><code class="language-typescript">// Errors are automatically transformed and provide:
{
  name: &#39;ServiceFetchError&#39;,
  code: &#39;LIST_FETCH_ERROR&#39; | &#39;SERVICE_FETCH_ERROR&#39; | &#39;VALIDATION_ERROR&#39;,
  operation: &#39;LIST_FETCH&#39; | &#39;SERVICE_FETCH&#39; | &#39;VALIDATION&#39;,
  httpStatus?: number,
  originalError?: Error
}
</code></pre>
<h2>Cart Functionality</h2>
<h3>Cart State Structure</h3>
<pre><code class="language-typescript">interface ServicesCartState {
  items: Record&lt;string, CartItem&gt;; // Keyed by serviceId
  totalItems: number; // Sum of all quantities
  lastUpdated: string | null; // ISO timestamp
}

interface CartItem {
  id: string; // serviceId
  qty: number; // quantity (1-20 per service)
  service: Service; // full service data
  addedAt: string; // ISO timestamp
}
</code></pre>
<h3>Cart Actions</h3>
<pre><code class="language-typescript">// Add service to cart
dispatch(addToCart({service, qty: 1}));

// Remove quantity from cart
dispatch(removeFromCart({serviceId, qty: 1}));

// Update specific quantity
dispatch(updateQuantity({serviceId, qty: 5}));

// Remove service completely
dispatch(removeService({serviceId}));

// Clear entire cart
dispatch(clearCart());
</code></pre>
<h3>Cart Limits</h3>
<ul>
<li><strong>Maximum 20 items total</strong> across all services</li>
<li><strong>No limit per individual service</strong> (within the 20 total)</li>
<li>Attempts to exceed limit are blocked with user feedback</li>
</ul>
<h3>Cart Persistence</h3>
<p>Cart state is persisted using encrypted storage and survives:</p>
<ul>
<li>App restarts</li>
<li>App updates</li>
<li>Device restarts</li>
</ul>
<p><strong>Corruption Handling:</strong></p>
<ul>
<li>Invalid cart data is automatically reset to empty state</li>
<li>User is not logged out (cart is non-critical data)</li>
<li>Errors are logged for debugging</li>
</ul>
<h2>Services Screen UI</h2>
<h3>User Experience</h3>
<h4>Initial State</h4>
<ul>
<li>Shows list of 5-8 active services</li>
<li>Each service card has an &quot;ADD&quot; button</li>
<li>Empty cart badge (hidden)</li>
</ul>
<h4>Adding Items</h4>
<ol>
<li>User taps &quot;ADD&quot; button</li>
<li>Success alert confirms addition</li>
<li>Button transforms to quantity controls: <code>[- | 1 | +]</code></li>
<li>Cart badge appears showing total count</li>
</ol>
<h4>Quantity Management</h4>
<ul>
<li><strong>Plus (+)</strong> button: Increases quantity</li>
<li><strong>Minus (-)</strong> button: Decreases quantity</li>
<li><strong>When quantity reaches 0</strong>: Controls disappear, &quot;ADD&quot; button returns</li>
</ul>
<h4>Cart Full State</h4>
<ul>
<li>When total reaches 20 items:<ul>
<li>&quot;ADD&quot; buttons for new services show &quot;Cart Full&quot;</li>
<li>Existing services can still be adjusted</li>
<li>User gets explanatory alert if they try to add new services</li>
</ul>
</li>
</ul>
<h3>Accessibility Features</h3>
<h4>Screen Reader Support</h4>
<ul>
<li>Service cards: Full service name and description announced</li>
<li>ADD buttons: &quot;Add [Service Name] to cart&quot;</li>
<li>Quantity controls: &quot;Increase/Decrease [Service Name] quantity&quot;</li>
<li>Cart badge: &quot;Cart has X items&quot; with live region updates</li>
</ul>
<h4>Voice Control</h4>
<ul>
<li>Unique, speakable labels for all interactive elements</li>
<li>Clear action feedback</li>
</ul>
<h4>Focus Management</h4>
<ul>
<li>Logical tab order through services</li>
<li>Clear focus indicators</li>
</ul>
<h2>Refresh System Integration</h2>
<p>The Services Screen integrates with the unified refresh system:</p>
<pre><code class="language-typescript">const {refreshAll, isRefreshing, refreshError} = useRefreshControl();

// Pull-to-refresh triggers refresh of ALL app APIs (services, auth, leads)
// 60-second throttle prevents excessive requests
</code></pre>
<h2>Error States</h2>
<h3>API Failure</h3>
<ul>
<li>Shows error message with &quot;Retry&quot; button</li>
<li>&quot;View Details&quot; shows specific error information</li>
<li>Graceful degradation maintains cart functionality</li>
</ul>
<h3>Network Issues</h3>
<ul>
<li>Standard error state (no special offline mode)</li>
<li>User can retry when connection restored</li>
</ul>
<h3>Empty State</h3>
<ul>
<li>Shows when no services are available</li>
<li>Includes last refresh timestamp</li>
<li>Maintains cart functionality</li>
</ul>
<h2>Performance Characteristics</h2>
<ul>
<li><strong>Service loading</strong>: &lt; 2 seconds on good network</li>
<li><strong>Cart operations</strong>: Instant (local state)</li>
<li><strong>UI updates</strong>: Real-time via Redux</li>
<li><strong>Memory usage</strong>: Minimal (5-8 services max)</li>
</ul>
<h2>Development Patterns</h2>
<h3>Adding New Cart Features</h3>
<ol>
<li><p><strong>Update cart slice</strong> (<code>servicesCartSlice.ts</code>):</p>
<pre><code class="language-typescript">// Add new action
newCartAction: (state, action) =&gt; {
  // Update state
  state.lastUpdated = new Date().toISOString();
};
</code></pre>
</li>
<li><p><strong>Add to hook</strong> (<code>useCartActions.ts</code>):</p>
<pre><code class="language-typescript">const handleNewAction = useCallback(() =&gt; {
  dispatch(newCartAction(payload));
}, [dispatch]);
</code></pre>
</li>
<li><p><strong>Update UI</strong> to use new action</p>
</li>
<li><p><strong>Add tests</strong> for new functionality</p>
</li>
</ol>
<h3>Debugging Tips</h3>
<h4>Cart State Issues</h4>
<pre><code class="language-typescript">// Check current cart state
console.log(store.getState().servicesCart);

// Clear cart for testing
store.dispatch(clearCart());
</code></pre>
<h4>API Issues</h4>
<pre><code class="language-typescript">// Check network requests in Chrome DevTools
// Services API calls appear as: GET /api/v1/services?active=true
</code></pre>
<h2>Testing</h2>
<p>See <code>docs/Testing.md</code> for comprehensive testing documentation.</p>
<h2>Security Considerations</h2>
<ul>
<li><strong>Encrypted Storage</strong>: All cart data persisted securely</li>
<li><strong>No Sensitive Data</strong>: Cart contains only serviceIds and quantities</li>
<li><strong>Input Validation</strong>: All quantities validated (positive integers only)</li>
<li><strong>XSS Protection</strong>: Service data sanitized before display</li>
</ul>
<h2>Troubleshooting</h2>
<h3>Cart Not Persisting</h3>
<ol>
<li>Check encrypted storage permissions</li>
<li>Verify persistConfig includes &#39;servicesCart&#39;</li>
<li>Check browser/device storage quota</li>
</ol>
<h3>Services Not Loading</h3>
<ol>
<li>Check network connectivity</li>
<li>Verify API endpoint accessibility</li>
<li>Check browser console for CORS errors</li>
</ol>
<h3>Performance Issues</h3>
<ol>
<li>Services list is limited to 5-8 items (not a scaling concern)</li>
<li>Cart operations are O(1) for individual items</li>
<li>UI updates are optimized with React.memo where appropriate</li>
</ol>
<h2>Future Enhancements</h2>
<p>Potential areas for expansion:</p>
<ul>
<li><strong>Cart Screen</strong>: Dedicated cart management interface</li>
<li><strong>Checkout Flow</strong>: Integration with order processing</li>
<li><strong>Service Categories</strong>: Filtering and grouping</li>
<li><strong>Price Display</strong>: Show actual pricing when available</li>
<li><strong>Favorites</strong>: Bookmark frequently used services</li>
</ul>

        </div>
    </div>
</body>
</html>
