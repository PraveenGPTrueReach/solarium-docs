
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Testing Services & Cart - Solarium Customer App</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: #f8f9fa;
        }
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100vh;
            background: #ffffff;
            padding: 0;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            border-right: 1px solid #e9ecef;
        }
        .sidebar h3 {
            background: #007bff;
            color: white;
            margin: 0;
            padding: 20px;
            font-size: 18px;
            font-weight: 600;
        }
        .nav-section {
            padding: 20px 0;
        }
        .nav-section h4 {
            color: #6c757d;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0 20px 10px 20px;
            padding: 0;
        }
        .nav-link {
            display: block;
            color: #495057;
            text-decoration: none;
            padding: 12px 20px;
            border-left: 3px solid transparent;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        .nav-link:hover {
            background: #f8f9fa;
            color: #007bff;
            border-left-color: #007bff;
        }
        .nav-link.active {
            background: #e3f2fd;
            color: #007bff;
            border-left-color: #007bff;
        }
        .main-content {
            margin-left: 280px;
            padding: 40px;
            background: white;
            min-height: 100vh;
        }
        .content {
            max-width: 800px;
            line-height: 1.6;
        }
        pre {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            border: 1px solid #e9ecef;
        }
        code {
            background: #f8f9fa;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 0.9em;
            color: #e83e8c;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2, h3 {
            color: #2c3e50;
            margin-top: 30px;
        }
        .breadcrumb {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 14px;
            color: #6c757d;
        }
        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                width: 100%;
                height: auto;
            }
            .main-content {
                margin-left: 0;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h3>Solarium Customer App</h3>
        <nav>
            <div class="nav-section"><a href="index.html" class="nav-link">üè† Home</a></div><div class="nav-section"><h4>Core Features</h4><a href="CartCheckout.html" class="nav-link">Cart Checkout</a><a href="CartFunctionality.html" class="nav-link">Cart Functionality</a><a href="KycUploadLibrary.html" class="nav-link">KYC Upload Library</a><a href="ServicesCatalogue.html" class="nav-link">Services Catalogue</a><a href="profile-feature.html" class="nav-link">Profile Management</a></div><div class="nav-section"><h4>Support System</h4><a href="TicketManagement.html" class="nav-link">Ticket Management System</a></div><div class="nav-section"><h4>Testing & QA</h4><a href="TESTING.html" class="nav-link">Testing Guide</a><a href="Testing_services_cart.html" class="nav-link">Testing Services & Cart</a></div><div class="nav-section"><h4>DevOps</h4><a href="CI_CD.html" class="nav-link">CI/CD Pipeline</a></div><div class="nav-section"><h4>Other</h4><a href="LeadDetail.html" class="nav-link">Lead Detail</a></div>
        </nav>
    </div>
    <div class="main-content">
        <div class="breadcrumb">Documentation ‚Üí Testing Services & Cart</div>
        <div class="content">
            <h1>Testing Documentation</h1>
<h2>Overview</h2>
<p>This document covers testing strategies for the Services Catalogue and Cart functionality, including unit tests, integration tests, and accessibility testing.</p>
<h2>Test Architecture</h2>
<h3>Testing Stack</h3>
<ul>
<li><strong>Jest</strong>: Test runner and assertion library</li>
<li><strong>React Testing Library</strong>: Component testing utilities</li>
<li><strong>MSW (Mock Service Worker)</strong>: API mocking</li>
<li><strong>Redux Test Utils</strong>: Store testing helpers</li>
</ul>
<h3>Test Categories</h3>
<ol>
<li><strong>Unit Tests</strong>: Individual functions and components</li>
<li><strong>Integration Tests</strong>: Feature workflows and API integration</li>
<li><strong>Accessibility Tests</strong>: Screen reader and WCAG compliance</li>
<li><strong>Performance Tests</strong>: Load times and memory usage</li>
</ol>
<h2>Test Scripts</h2>
<pre><code class="language-bash"># Run all tests
yarn test

# Run with coverage
yarn test:coverage

# Run specific test suites
yarn test:cart          # Cart functionality tests
yarn test:services      # Services screen tests
yarn test:a11y:services # Accessibility tests
yarn test:integration:all # All integration tests

# Run tests in watch mode
yarn test:watch

# Run tests for CI/CD
yarn test:ci
</code></pre>
<h2>MSW Mock Server</h2>
<h3>Setup</h3>
<p>MSW provides reliable API mocking without network dependencies:</p>
<pre><code class="language-typescript">// src/__tests__/msw/handlers.ts
export const handlers = [
  http.get(&#39;/api/v1/services&#39;, () =&gt; {
    return HttpResponse.json({
      success: true,
      data: {items: mockServices},
    });
  }),
];
</code></pre>
<h3>Mock Data</h3>
<pre><code class="language-typescript">// 5 realistic solar services for testing
const mockServices = [
  {
    serviceId: &#39;solar-panel-install&#39;,
    name: &#39;Solar Panel Installation&#39;,
    description: &#39;Complete installation service&#39;,
    type: &#39;installation&#39;,
    active: true,
    priceRange: {min: 50000, max: 150000, currency: &#39;INR&#39;},
  },
  // ... 4 more services
];
</code></pre>
<h3>Error Scenarios</h3>
<pre><code class="language-typescript">// Test API failures
global.mockServer.use(
  http.get(&#39;/api/v1/services&#39;, () =&gt; {
    return HttpResponse.json(
      {success: false, error: &#39;Server error&#39;},
      {status: 500}
    );
  })
);
</code></pre>
<h2>Unit Testing</h2>
<h3>Cart Slice Tests</h3>
<h4>Testing Actions</h4>
<pre><code class="language-typescript">describe(&#39;servicesCartSlice&#39;, () =&gt; {
  it(&#39;should add service to cart&#39;, () =&gt; {
    const action = addToCart({service: mockService, qty: 2});
    const state = cartReducer(initialState, action);

    expect(state.items[mockService.serviceId]).toBeDefined();
    expect(state.items[mockService.serviceId].qty).toBe(2);
    expect(state.totalItems).toBe(2);
  });
});
</code></pre>
<h4>Testing Business Rules</h4>
<pre><code class="language-typescript">it(&#39;should enforce 20-item limit&#39;, () =&gt; {
  // Fill cart to 18 items
  const stateWith18Items = {
    items: {service1: {id: &#39;service1&#39;, qty: 18, service: mockService}},
    totalItems: 18,
  };

  // Try to add 5 more items (would exceed limit)
  const action = addToCart({service: anotherService, qty: 5});
  const state = cartReducer(stateWith18Items, action);

  // Should not add anything
  expect(state.totalItems).toBe(18);
  expect(state.items[&#39;service2&#39;]).toBeUndefined();
});
</code></pre>
<h4>Testing Edge Cases</h4>
<pre><code class="language-typescript">it(&#39;should handle corrupted cart data&#39;, () =&gt; {
  const corruptedState = {items: null, totalItems: &#39;invalid&#39;};

  expect(() =&gt; {
    validateCartState(corruptedState);
  }).not.toThrow();

  expect(validateCartState(corruptedState)).toBe(false);
});
</code></pre>
<h3>Hook Tests</h3>
<h4>Testing useCartActions</h4>
<pre><code class="language-typescript">describe(&#39;useCartActions&#39;, () =&gt; {
  it(&#39;should provide cart actions and state&#39;, () =&gt; {
    const {result} = renderHook(() =&gt; useCartActions(), {
      wrapper: ({children}) =&gt; &lt;Provider store={store}&gt;{children}&lt;/Provider&gt;,
    });

    expect(result.current.addToCart).toBeInstanceOf(Function);
    expect(result.current.cartCount).toBe(0);
    expect(result.current.isCartEmpty).toBe(true);
  });
});
</code></pre>
<h2>Integration Testing</h2>
<h3>Cart Flow Tests</h3>
<h4>Complete User Journey</h4>
<pre><code class="language-typescript">describe(&#39;Cart Flow Integration&#39;, () =&gt; {
  it(&#39;should handle complete add-to-cart flow&#39;, async () =&gt; {
    const {getByText, getAllByText} = render(
      &lt;TestWrapper&gt;
        &lt;ServicesScreen /&gt;
      &lt;/TestWrapper&gt;
    );

    // Wait for services to load
    await waitFor(() =&gt; {
      expect(getByText(&#39;Solar Panel Installation&#39;)).toBeTruthy();
    });

    // Add to cart
    const addButtons = getAllByText(&#39;ADD&#39;);
    fireEvent.press(addButtons[0]);

    // Verify success feedback
    await waitFor(() =&gt; {
      expect(Alert.alert).toHaveBeenCalledWith(
        &#39;Added to Cart&#39;,
        expect.stringContaining(&#39;has been added&#39;)
      );
    });

    // Verify UI update
    expect(getByText(&#39;1&#39;)).toBeTruthy(); // Quantity display
  });
});
</code></pre>
<h4>Quantity Control Testing</h4>
<pre><code class="language-typescript">it(&#39;should handle quantity increment/decrement&#39;, async () =&gt; {
  // ... setup code

  // Add initial item
  fireEvent.press(getByText(&#39;ADD&#39;));
  await waitFor(() =&gt; expect(getByText(&#39;1&#39;)).toBeTruthy());

  // Increment
  const plusButton = getByLabelText(/Increase.*quantity/);
  fireEvent.press(plusButton);
  await waitFor(() =&gt; expect(getByText(&#39;2&#39;)).toBeTruthy());

  // Decrement back to zero (should show ADD button)
  const minusButton = getByLabelText(/Decrease.*quantity/);
  fireEvent.press(minusButton);
  fireEvent.press(minusButton);

  await waitFor(() =&gt; {
    expect(queryByText(&#39;1&#39;)).toBeNull();
    expect(getByText(&#39;ADD&#39;)).toBeTruthy();
  });
});
</code></pre>
<h3>API Integration Tests</h3>
<h4>Services Loading</h4>
<pre><code class="language-typescript">describe(&#39;Services API Integration&#39;, () =&gt; {
  it(&#39;should load services from API&#39;, async () =&gt; {
    const {getByText} = render(
      &lt;TestWrapper&gt;
        &lt;ServicesScreen /&gt;
      &lt;/TestWrapper&gt;
    );

    await waitFor(() =&gt; {
      expect(getByText(&#39;Solar Panel Installation&#39;)).toBeTruthy();
      expect(getByText(&#39;Solar Panel Maintenance&#39;)).toBeTruthy();
    });
  });

  it(&#39;should handle API errors gracefully&#39;, async () =&gt; {
    // Mock API failure
    global.mockServer.use(
      http.get(&#39;/api/v1/services&#39;, () =&gt;
        HttpResponse.json({error: &#39;Server error&#39;}, {status: 500})
      )
    );

    const {getByText} = render(
      &lt;TestWrapper&gt;
        &lt;ServicesScreen /&gt;
      &lt;/TestWrapper&gt;
    );

    await waitFor(() =&gt; {
      expect(getByText(&#39;Failed to Load Services&#39;)).toBeTruthy();
      expect(getByText(&#39;Retry&#39;)).toBeTruthy();
    });
  });
});
</code></pre>
<h2>Accessibility Testing</h2>
<h3>Screen Reader Support</h3>
<pre><code class="language-typescript">describe(&#39;Services Screen Accessibility&#39;, () =&gt; {
  it(&#39;should have accessible service cards&#39;, async () =&gt; {
    const {getByLabelText} = render(
      &lt;TestWrapper&gt;
        &lt;ServicesScreen /&gt;
      &lt;/TestWrapper&gt;
    );

    await waitFor(() =&gt; {
      const serviceCard = getByLabelText(
        /Solar Panel Installation.*installation service.*Complete solar panel installation/
      );
      expect(serviceCard).toBeTruthy();
      expect(serviceCard.props.accessibilityRole).toBe(&#39;button&#39;);
      expect(serviceCard.props.accessibilityHint).toBe(
        &#39;Tap to view service details&#39;
      );
    });
  });

  it(&#39;should have accessible cart controls&#39;, async () =&gt; {
    // ... setup and add item to cart

    const quantityControl = getByLabelText(/quantity: 1/);
    expect(quantityControl.props.accessibilityRole).toBe(&#39;adjustable&#39;);

    const plusButton = getByLabelText(/Increase.*quantity/);
    expect(plusButton.props.accessibilityRole).toBe(&#39;button&#39;);
    expect(plusButton.props.accessibilityHint).toContain(&#39;Will increase to 2&#39;);
  });
});
</code></pre>
<h3>Cart Badge Accessibility</h3>
<pre><code class="language-typescript">it(&#39;should announce cart updates via live region&#39;, async () =&gt; {
  // Add items and verify badge accessibility
  const cartBadge = getByLabelText(/Cart has \d+ item/);
  expect(cartBadge.props.accessibilityLiveRegion).toBe(&#39;polite&#39;);
  expect(cartBadge.props.accessibilityRole).toBe(&#39;text&#39;);
});
</code></pre>
<h2>Performance Testing</h2>
<h3>Load Time Testing</h3>
<pre><code class="language-typescript">describe(&#39;Performance&#39;, () =&gt; {
  it(&#39;should load services within 2 seconds&#39;, async () =&gt; {
    const startTime = Date.now();

    const {getByText} = render(
      &lt;TestWrapper&gt;
        &lt;ServicesScreen /&gt;
      &lt;/TestWrapper&gt;
    );

    await waitFor(() =&gt; {
      expect(getByText(&#39;Solar Panel Installation&#39;)).toBeTruthy();
    });

    const loadTime = Date.now() - startTime;
    expect(loadTime).toBeLessThan(2000);
  });
});
</code></pre>
<h2>Test Data Management</h2>
<h3>Mock Service Data</h3>
<pre><code class="language-typescript">// Consistent mock data across tests
export const mockServices: Service[] = [
  {
    serviceId: &#39;solar-panel-install&#39;,
    name: &#39;Solar Panel Installation&#39;,
    // ... realistic service data
  },
  // ... 4 more services matching production variety
];
</code></pre>
<h3>Test Store Setup</h3>
<pre><code class="language-typescript">// Reusable test store configuration
export const createTestStore = (preloadedState = {}) =&gt; {
  return configureStore({
    reducer: rootReducer,
    preloadedState,
    middleware: getDefaultMiddleware =&gt;
      getDefaultMiddleware({
        serializableCheck: false, // Disable for testing
      }),
  });
};
</code></pre>
<h2>Coverage Requirements</h2>
<h3>Coverage Thresholds</h3>
<pre><code class="language-javascript">// jest.config.js
coverageThreshold: {
  global: {
    branches: 82,
    functions: 82,
    lines: 82,
    statements: 82,
  },
  // Higher for business logic
  &#39;./src/store/servicesCartSlice.ts&#39;: {
    branches: 95,
    functions: 95,
    lines: 95,
    statements: 95,
  },
  &#39;./src/hooks/useCartActions.ts&#39;: {
    branches: 90,
    functions: 90,
    lines: 90,
    statements: 90,
  },
}
</code></pre>
<h3>Coverage Reports</h3>
<pre><code class="language-bash"># Generate HTML coverage report
yarn test:coverage

# View report
open coverage/lcov-report/index.html
</code></pre>
<h2>Debugging Tests</h2>
<h3>Common Issues</h3>
<h4>Tests Timing Out</h4>
<pre><code class="language-typescript">// Increase timeout for slow operations
await waitFor(
  () =&gt; {
    expect(getByText(&#39;Expected Text&#39;)).toBeTruthy();
  },
  {timeout: 5000}
);
</code></pre>
<h4>Mock Server Issues</h4>
<pre><code class="language-typescript">// Reset handlers between tests
afterEach(() =&gt; {
  global.mockServer.resetHandlers();
});

// Debug request matching
global.mockServer.listHandlers().forEach(handler =&gt; {
  console.log(&#39;Handler:&#39;, handler.info.header);
});
</code></pre>
<h4>Redux State Issues</h4>
<pre><code class="language-typescript">// Debug store state in tests
console.log(&#39;Store state:&#39;, store.getState());

// Check action dispatching
const dispatch = jest.spyOn(store, &#39;dispatch&#39;);
expect(dispatch).toHaveBeenCalledWith(addToCart(expectedPayload));
</code></pre>
<h2>CI/CD Integration</h2>
<h3>GitHub Actions</h3>
<pre><code class="language-yaml"># .github/workflows/test.yml
- name: Run Tests
  run: |
    yarn test:ci
    yarn test:a11y
    yarn test:integration:all
</code></pre>
<h3>Coverage Reporting</h3>
<pre><code class="language-bash"># Upload to codecov or similar
yarn test:coverage &amp;&amp; codecov
</code></pre>
<h2>Best Practices</h2>
<h3>Test Organization</h3>
<ul>
<li><strong>Group related tests</strong> in describe blocks</li>
<li><strong>Use descriptive test names</strong> that explain the scenario</li>
<li><strong>Follow AAA pattern</strong>: Arrange, Act, Assert</li>
<li><strong>Clean up after tests</strong> to prevent interference</li>
</ul>
<h3>Mock Management</h3>
<ul>
<li><strong>Use MSW for API mocking</strong> (not jest.mock for fetch)</li>
<li><strong>Keep mock data realistic</strong> and consistent</li>
<li><strong>Test both success and error scenarios</strong></li>
<li><strong>Reset mocks between tests</strong></li>
</ul>
<h3>Accessibility Testing</h3>
<ul>
<li><strong>Test with actual screen reader scenarios</strong></li>
<li><strong>Verify ARIA labels and roles</strong></li>
<li><strong>Check focus management</strong></li>
<li><strong>Test voice control compatibility</strong></li>
</ul>
<h3>Performance Testing</h3>
<ul>
<li><strong>Set realistic performance budgets</strong></li>
<li><strong>Test on various device capabilities</strong></li>
<li><strong>Monitor memory usage in long-running tests</strong></li>
<li><strong>Profile render performance</strong></li>
</ul>

        </div>
    </div>
</body>
</html>
